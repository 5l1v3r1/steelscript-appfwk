# Copyright (c) 2014 Riverbed Technology, Inc.
#
# This software is licensed under the terms and conditions of the MIT License
# accompanying the software ("License").  This software is distributed "AS IS"
# as set forth in the License.

"""
This file defines helper functions used by reports: analysis functions,
as well as pre and post processing criteria functions.

"""

def func_{{name}}_table_limits(query, tables, criteria, params):
    """Process the incoming 'waves' table and apply clipping limits.

    :param query: TableQuery associated with this table
    :param dict tables: dictionary of dependent and related tables
    :param criteria: object containing user provided criterie
    :param params: additional parameters

    :returns: DataFrame
    """

    # Grab the incoming 'waves' table, which will have already been
    # run prior to this call.  The result is a pandas DataFrame
    waves = tables['waves']

    # Index on 'time' -- this allows the next operation to proceed
    # only the remaining columns
    waves = waves.set_index('time')

    # Apply lower and upper limits to all data columns
    waves = waves.clip(lower=int(criteria.min), upper=int(criteria.max))

    # Reset the index before returning
    waves = waves.reset_index()

    # Return the result as another DataFrame
    return waves
